import pandas as pd

# Sample DataFrame
data = {
    'name': ['Mr. John spa', 'Dr. Jane Doe', 'Ms. Smith spa', 'me Anderson', 'mm Thompson', 'spa Mr. Brown'],
    'age': [30, 45, 23, 34, 28, 50]
}
df = pd.DataFrame(data)

# Apply conditions directly using a lambda function
df['new_column'] = df['name'].apply(
    lambda name: 'PP' if name.startswith('spa') or name.endswith('spa') or any(name.startswith(prefix) for prefix in ['Mr', 'mm', 'me']) else ''
)

print(df)
